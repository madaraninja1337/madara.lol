<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Business Logic Flaws · madara.lol</title>
  <style>
    :root { --bg:#0d0d0d; --fg:#e5e5e5; --accent:#ff4040; }
    *{box-sizing:border-box;margin:0;padding:0}
    body{min-height:100vh;background:var(--bg);color:var(--fg);font-family:"Fira Code",monospace;line-height:1.6;display:flex;flex-direction:column;align-items:center}
    article{max-width:720px;padding:2rem 1rem}
    h1{margin-bottom:.5rem;font-size:clamp(2.5rem,6vw,4rem);color:var(--accent)}
    .meta{font-size:.85rem;opacity:.65;margin-bottom:2rem}
    h2{margin-top:2rem;font-size:1.4rem}
    p{margin:1rem 0}
    ul{margin:1rem 0 1rem 1.5rem}
    li{margin-bottom:.5rem}
    pre{background:#1a1a1a;padding:1rem;overflow-x:auto}
    a{color:var(--accent);text-decoration:none}
    a:hover{text-decoration:underline}
  </style>
</head>
<body>

<article>
  <h1>BUSINESS LOGIC FLAW: THE FAVORITE VULNERABILITY OF MAJOR PROGRAMS</h1>
  <p class="meta">Revised — 28 Apr 2025 · madaraninja1337</p>

  <h2>Why Business Logic Flaws Matter</h2>
  <p>When code works but the rules behind it are weak, attackers win. These business-logic bugs (BLVs) pay well because scanners miss them. In HackerOne’s 2024 stats they had the highest average reward across big companies. See the numbers <a href="https://github.com/reddelexc/hackerone-reports/blob/master/tops_by_bug_type/TOPBUSINESSLOGIC.md" target="_blank" rel="noopener">here</a>.</p>

  <h2>What Is a Business Logic Vulnerability?</h2>
  <p>OWASP says a BLV is a design mistake that lets users do things the business never meant. The attacker stays inside normal features, but bends them for profit. A short intro lives on <a href="https://portswigger.net/web-security/logic-flaws" target="_blank" rel="noopener">PortSwigger</a>.</p>

  <h2>Learn the Real Rules First</h2>
  <ul>
    <li><strong>Use the product like a heavy user</strong>. Sign up, buy, cancel, refund. Watch emails, balance changes, and tokens.</li>
    <li><strong>Read docs and help pages</strong>. Any promise such as “Gift cards are single-use” is a test idea.</li>
    <li><strong>Log every request</strong> with Burp or mitmproxy. Play them back out of order or with new values.</li>
    <li><strong>Create many roles</strong> (guest, paid, admin) and compare what each can call.</li>
    <li><strong>Watch time limits</strong>. Tokens, quotas, or price windows often reset in ways you can abuse.</li>
    <li><strong>Draw the money path</strong>. Where does the app hold, debit, or release funds? Gaps here pay well.</li>
  </ul>

  <h2>Real Reports to Learn From</h2>
  <ul>
    <li><strong>Unlimited fee discount at Stripe</strong>. Promo coupons were reduced only after payment. A researcher re-used the same code in two parallel payments and skipped all fees. Read the report on <a href="https://www.hackerone.com/blog/how-business-logic-vulnerability-led-unlimited-discount-redemption" target="_blank" rel="noopener">HackerOne</a>.</li>
    <li><strong>GitLab template leak</strong>. Public project templates copied private merge requests during cloning, sending private code to strangers. Full write-up <a href="https://hackerone.com/reports/689314" target="_blank" rel="noopener">here</a>.</li>
    <li><strong>MFA bypass via GraphQL</strong>. An e-commerce site checked MFA on REST but forgot it on GraphQL. An attacker used GraphQL to grant admin and edit the home page. See details <a href="https://www.hackerone.com/blog/how-graphql-bug-resulted-authentication-bypass" target="_blank" rel="noopener">here</a>.</li>
  </ul>

  <h2>Simple Hunting Framework</h2>
  <h3>1. Map the Flow</h3>
  <p>Sketch each state: guest → user, cart → order, pending → shipped. Include hidden API calls.</p>

  <h3>2. Write Down Assumptions</h3>
  <p>Ask “What must be true now?” Token unused? Stock ≥ 1? Balance ≥ price?</p>

  <h3>3. Break the Assumptions</h3>
  <ul>
    <li><strong>Change inputs</strong>: IDs, prices, roles, counts.</li>
    <li><strong>Skip steps</strong>: Send the last call before the first.</li>
    <li><strong>Race it</strong>: Two calls at once can beat checks. Tips on races are <a href="https://portswigger.net/web-security/race-conditions" target="_blank" rel="noopener">here</a>.</li>
    <li><strong>Hold two sessions</strong> and watch how the server stays in sync.</li>
  </ul>

  <h2>Takeaways</h2>
  <p>Business-logic flaws hide in the rules, not the code. Learn the rules, think like a sneaky insider, and you will find bugs scanners miss—and companies pay you to fix.</p>

  <p class="meta"><sup>*</sup>See the formal OWASP text on <a href="https://owasp.org/www-community/vulnerabilities/Business_logic_vulnerability" target="_blank" rel="noopener">business-logic vulnerabilities</a>.</p>
  <p><a href="/">← Back to madara.lol</a></p>
</article>

</body>
</html>
